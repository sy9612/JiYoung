### [DB] SQL, 인덱스, 뷰

----

#### **SQL (Structured Query Language)**

SQL은 관계형 데이터베이스 관리 시스템(RDBMS)의 데이터를 관리하기 위해 설계된 프로그래밍 언어이다. 

관계형 데이터 베이스 관리 시스템에서 자료의 검색과 관리, 데이터베이스 스키마 생성과 수정, 데이터 베이스 객체 접근 조정 관리를 위해 고안되었다.



**DDL (Data Definition Language)**

SCHEMA, DOMAIN, TABLE, VIEW, INDEX를 정의하거나 변경 또는 삭제할 때 사용하는 언어.

데이터베이스 관리자나 데이터베이스 설계자가 사용.

- CREATE: 데이터베이스 객체 생성.
- DROP: 데이터베이스 객체 삭제.
- ALTER: 데이터베이스 객체 변경.
- RENAME: 데이터베이스 객체 이름 변경.
- TRUNCATE: 데이터베이스 객체의 저장 공간 삭제.



**DML (Data Manipulation Language)**

데이터베이스 사용자가 응용 프로그램이나 질의어를 통하여 저장된 데이터를 실질적으로 처리하는데 사용하는 언어. 

데이터베이스 사용자와 데이터베이스 관리 시스템 간의 인터페이스 제공. 

* INSERT(C): 데이터 삽입.

* SELECT(R): 데이터 조회. SELECT만 별도로 떼어내 DQL(Data Query Language)이라 표현하기도 한다.

* UPDATE(U): 데이터 변경.

* DELETE(D): 데이터 삭제.

  

**DCL (Data Control Language)**

데이터의 보안, 무결성, 데이터 회복, 병행 수행 제어 등을 정의하는 데 사용하는 언어.

데이터베이스 관리자가 데이터 관리를 목적으로 사용.

* GRANT: 데이터베이스에 접근하고 객체를 사용할 수 있는 권한 부여.

* REVOKE:  부여한 권환 회수.

  

**TCL (Transaction Control Language)**

논리적인 작업의 단위를 묶어서 DML에 의해 조작된 결과를 작업단위(트랜잭션) 별로 제어하는 명령어.

* COMMIT: SQL문의 결과를 영구적으로 DB에 반영.
* ROLLBACK: SQL문의 결과 취소. 데이터 변경 후 되돌릴 때 사용.

* SAVEPOINT: 트랜잭션의 임시저장점 설정.

-----

#### **트랜잭션 (Transaction)**

![트랜잭션](https://itwiki.kr/images/1/1e/%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98_%EC%83%81%ED%83%9C%EC%A0%84%EC%9D%B4%EB%8F%84.png)

데이터베이스 상태를 변환시키는 하나의 논리적 기능을 수행하기 위한 작업의 단위.

데이터베이스의 완전성을 보장하기 위한것이 목적으로 하기 때문에 정상적으로 실행되었을 경우에는 commit이 이루어지고, 그렇지 않을 경우에는 rollback이 실행되면서 데이터베이스에는 아무런 영향을 끼치지 않는다. (all or nothing)



**트랜잭션의 특성**

- 원자성(Atomicity) : 트랜잭션의 연산은 데이터베이스에 모두 반영되든지 아니면 전혀 반영되지 않아야 한다.
- 일관성(Consistency) : 실행을 성공적으로 완료하면 언제나 일관성있는 데이터베이스 상태로 변환한다.
- 독립성(Isolation) : 실행중에 있는 연산의 중간 결과에 다른 트랜잭션이 접근할 수 없다.
- 지속성(Durability) : 일단 실행이 성공적으로 완료 되면 결과는 지속적이어야 한다.

-----

#### **인덱스 (Index)**

추가적인 쓰기 작업과 저장 공간을 활용하여 데이터베이스 테이블의 검색 속도를 향상시키기 위한 자료구조이다. 데이터를 논리적으로 정렬하여 검색과 정렬 작업의 속도를 높인다.

기본키에 대해서는 항상 DBMS가 내부적으로 정렬된 목록을 관리하기에 특정 행을 가져올 때 빠르게 처리되지만, 다른 열의 내용을 검색하거나 정렬시에는 하나하나 대조를 해보기 때문에 시간이 오래걸린다. 이 때 인덱스를 사용하면 검색속도가 향상된다.



**장점**

* 테이블을 조회하는 속도와 그에 따른 성능을 향상시킬 수 있다.

* 전반적인 시스템의 부하를 줄일 수 있다.



**단점**

- 인덱스를 관리하기 위한 추가 작업 및 DB의 약 10%에 해당하는 저장공간이 필요하다.
- 데이터 삽입, 변경 등이 일어날 때 매번 인덱스가 변경되기 때문에 성능이 떨어질 수 있다.

-----

#### **View**

허용된 데이터를 제한적으로 보여주기 위해서 하나 이상의 테이블을 합하여 만든 가상 테이블이다.

뷰는 기본테이블로부터 유도된 테이블이기 때문에 기본 테이블과 같은 형태의 구조를 사용하며, 조작도 기본 테이블과 거의 같다. 하지만 물리적으로 구현되어 있지는 않다.



**뷰 특징**

- 편리성: 필요한 데이터만 뷰로 정의해서 일반 테이블처럼 사용할 수 있기 때문에 관리가 용이하고 명령문이 간단해진다.
- 재사용성: 자주 사용되는 질의를 뷰로 미리 정의해 놓을 수 있다.
- 보안성: 각 사용자별로 필요한 데이터만 선별하여 보여줄 수 있으며, 중요한 질의의 경우 질의 내용을 암호화할 수 있다.


**장점**

- 논리적 데이터 독립성을 제공한다.
- 동일 데이터에 대해 동시에 여러사용자의 상이한 응용이나 요구를 지원해 준다.
- 사용자의 데이터관리를 간단하게 해준다.
- 접근 제어(뷰에 나타나지 않는 데이터를 안전하게 보호)를 통한 보안이 제공된다.

 

**단점**

- 독립적인 인덱스를 가질 수 없다.
- ALTER VIEW문을 사용할 수 없다. 즉 뷰의 정의를 변경할 수 없다.
- 뷰로 구성된 내용에 대한 삽입, 삭제, 갱신, 연산에 제약이 따른다.

-----

**참고**

[데이터베이스 기술 면접 준비](https://yubh1017.tistory.com/56)

[SQL 기초(1)](https://iamfreeman.tistory.com/entry/DBMS-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%96%B8%EC%96%B4-DDL-DML-DCL-TCL-%EC%9D%98-%EC%A0%95%EC%9D%98)

[SQL 기초(2)](https://mangkyu.tistory.com/24?category=761304)

[트랜잭션 기초](https://pyoungt.tistory.com/2)

[인덱스](https://mangkyu.tistory.com/96)

[뷰](https://velog.io/@gillog/DB-View)

-----

**심화 내용**

[쿼리 실행 순서](https://nive.tistory.com/148)

[SQL 내장함수](https://mangkyu.tistory.com/25?category=761304)

SQL 제약조건

서브쿼리

[트랜잭션 병행제어&회복](https://mangkyu.tistory.com/30?category=761304)

JOIN

데드락

