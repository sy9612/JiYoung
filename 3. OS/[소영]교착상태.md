**임계영역 (critical section)**

동일한 자원을 동시에 접근하는 작업을 실행하는 코드 영역

**mutex**

공유된 자원의 데이터를 여러 스레드가 접근하는 것을 막는 것

임계영역을 가진 스레드의 running time이 겹치지 않도록 단독으로 실행하게 하는 기술

다중 프로세스들의 공유 리소스에 대한 접근을 조율하기 위해 sycronized 또는 lock을 사용

**semaphore**

공유된 자원의 데이터를 여러 프로세스가 접근하는 것을 막는 것

리소스 상태를 나타내는 간단한 카운터로 생각

공유 리소스에 접근할 수 있는 프로세스의 최대 허용치 만큼 동시에 사용자가 접근하여 사용 가능

각 프로세스는 세마포어 값을 확인하고 변경 가능

**세마포어와 뮤텍스 차이**

|             |                 세마포어                 |                      뮤텍스                      |
| :---------: | :--------------------------------------: | :----------------------------------------------: |
| 동기화 대상 |                 1개 이상                 |                       1개                        |
|    소유     |                 소유불가                 |    소유가능<br />소유주가 이에 대한 책임을 짐    |
|    해제     |     소유하지 않은 쓰레드가 해제 가능     |         소유하고 있는 쓰레드가 해제 가능         |
|    범위     | 시스템 범위<br />시스템 상의 형태로 존재 | 프로세스 범위<br />프로세스 종료시 자동 clean up |
|             |           뮤텍스가 될 수 있음            |              세마포어가 될 수 없음               |



**교착상태(deadlock)**

**교착상태란?**

상호배제에 의해 나타나는 문제점

둘 이상의 프로세스들이 자원을 점유한 상태에서 서로 다른 프로세스가 점유하고 있는 자원을 요구하며 무한정 기다리는 현상

**교착 상태의 4가지 조건**

1. 상호 배제(mutual exclusion)

한번에 한 프로세스만 공유 자원을 사용

다른 프로세스는 공유 자원에 대한 접근이 제한, 요청한 자원 해제시까지 대기

2. 점유 대기(hold and wait)

자원을 최소한 하나 보유하고 다른 프로세스에 할당된 자원을 점유하기 위해 대기하는 프로세스가 존재

3. 비선점

한 프로세스가 다른 프로세스의 접근 권한을 강제로 취소 불가능

4. 환형 대기

대기 프로세스의 집합이 순환 형태로 자원을 대기하고 있음

**데드락 해결법**

- 데드락이 발생하지 않도록 **예방**
- 데드락 발생 가능성 인정, 적절하게 **회피**
- 데드락 발생 허용, 데드락 **탐지**하여 **회복**

**예방기법**

*데드락 발생 조건 4가지 중 하나를 제거*

- 상호배제: 한번에 여러 개의 프로세스가 공유자원을 사용할 수 있도록 함, 추후 동기화 관련 문제 발생 가능

- 점유및대기: 프로세스가 실행되기 전 필요한 모든 자원을 할당하여 프로세스 대기를 없애거나 자원이 점유되지 않은 상태에서만 자원을 요구

- 비선점: 자원을 점유하고 있는 프로세스가 다른 자원을 요구할 때 점유하고 있는 자원을 반납하고 요구한 자원을 사용하기 위해 기다리게 함

- 환형대기: 자원을 선형 순서로 분류, 고유 번호를 할당, 각 프로세스는  현재 점유한 자원의 고유번호보다 앞이나 뒤 어느 한쪽 방향으로만 자원을 요구하는 것

시스템의 처리량이나 효율성을 떨어트리는 단점이 발생할 수 있음

조금 덜 제한적인 방법으로 예방법의 단점 일부 해결 가능

**회피기법**

교착 상태가 발생할 가능성을 배제하지 않고 교착상태 발생 시 적절히 피해나가는 방법

주로 은행원 알고리즘 사용

**탐지 및 회복기법**

탐지기법: 데드락이 발생했는지 여부 탐색, 자원 할당 그래프를 통해 탐지

회복기법: 교착상태를 일으킨 프로세스를 종료하거나 교착상태의 프로세스에 할당된 자원을 선점하여 프로세스나 자원을 회복

- 자원을 선점하는 방법

  (1) 교착 상태의 프로세스가 점유하고 있는 자원을 선점하여 다른 프로세스에게 할당하며, 해당 프로세스를 일시 정지 시킴

  (2) 우선 순위가 낮은 프로세스, 수행된 횟수가 적은 프로세스 등을 위주로 프로세스의 자원을 선점

